/*!CK:2160940640!*//*1413168411,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["FN4II"]); }

__d("FeedTagSuggest",["ArbiterMixin","AsyncRequest","CSS","Event","mixin","SubscriptionsHandler"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=k(g);for(var n in m)if(m.hasOwnProperty(n))p[n]=m[n];var o=m===null?null:m.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=m;function p(q,r,s,t,u,v,w,x,y,z){"use strict";this.suggest=q;this.$FeedTagSuggest0=w;this.$FeedTagSuggest1=x;this.$FeedTagSuggest2=y;this.$FeedTagSuggest3=r;this.$FeedTagSuggest4=v;this.$FeedTagSuggest5=u;this.$FeedTagSuggest6=s;this.$FeedTagSuggest7=t;this.$FeedTagSuggest8=z;this.$FeedTagSuggest9=new l();this.$FeedTagSuggest9.addSubscriptions(j.listen(this.$FeedTagSuggest4,'click',this.dismissSuggestion.bind(this,'no')),j.listen(this.$FeedTagSuggest5,'click',this.acceptTagSuggestion.bind(this)));if(this.$FeedTagSuggest3)this.$FeedTagSuggest9.addSubscriptions(j.listen(this.$FeedTagSuggest3,'click',this.dismissSuggestion.bind(this,'close')));}p.prototype.dismissSuggestion=function(q){"use strict";var r=this.$FeedTagSuggest8.feed_type;new h().setURI('/ajax/dismiss_tag_suggest.php').setMethod('POST').setData({facebox_logs:[{facebox:this.$FeedTagSuggest1,log_data:this.$FeedTagSuggest8}],closing_source:r,closing_action:q}).setAllowCrossPageTransition(true).send();this.inform('remove');};p.prototype.tagSaveSuccess=function(q){"use strict";this.inform('remove');};p.prototype.acceptTagSuggestion=function(){"use strict";new h().setURI('/ajax/photo_feed_tagging_ajax.php').setMethod('POST').setData({photo_id:this.$FeedTagSuggest0,facebox_id:this.$FeedTagSuggest1,subject_id:this.$FeedTagSuggest2,log_data:this.$FeedTagSuggest8}).setErrorHandler(this.dismissSuggestion.bind(this,'err')).setAllowCrossPageTransition(true).setHandler(this.tagSaveSuccess.bind(this)).send();if(this.$FeedTagSuggest7){i.hide(this.$FeedTagSuggest6);i.show(this.$FeedTagSuggest7);}};p.prototype.cleanup=function(){"use strict";this.$FeedTagSuggest9.release();};e.exports=p;},null);
__d("LitestandTagSuggestContainer",["Animation","CSS","cx","csx","DOM","DOMQuery","Event","invariant","JSXDOM","Rect","SubscriptionsHandler","Style"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){function s(t,u,v,w){"use strict";this.$LitestandTagSuggestContainer0=new q();this.$LitestandTagSuggestContainer0.engage();this.$LitestandTagSuggestContainer1=t;this.$LitestandTagSuggestContainer2=v;this.$LitestandTagSuggestContainer3=w;h.show(this.$LitestandTagSuggestContainer1);var x=new p(v).w(),y=l.scry(t,"._5cne"),z=0;for(var aa=0;aa<y.length;aa++){h.show(y[aa]);var ba=new p(y[aa]).w();if(aa>0)h.hide(y[aa]);if(ba>z)z=ba;}if(z>x){h.hide(t);return;}this.$LitestandTagSuggestContainer4=[];this.$LitestandTagSuggestContainer5=false;u.forEach(this.registerSuggestion.bind(this));this.$LitestandTagSuggestContainer0.addSubscriptions(m.listen(this.$LitestandTagSuggestContainer1,'mouseenter',this.$LitestandTagSuggestContainer6.bind(this)),m.listen(this.$LitestandTagSuggestContainer1,'mouseleave',this.$LitestandTagSuggestContainer7.bind(this)));}s.prototype.registerSuggestion=function(t){"use strict";this.$LitestandTagSuggestContainer4.push(t);var u=t.js_instance;this.$LitestandTagSuggestContainer0.addSubscriptions(u.subscribe('remove',this.onRemove.bind(this,u)));};s.prototype.$LitestandTagSuggestContainer8=function(t){"use strict";if(!this.$LitestandTagSuggestContainer9){var u=this.$LitestandTagSuggestContainer2.children[0];this.$LitestandTagSuggestContainera={top:parseInt(r.get(u,'top'),10)||0,left:parseInt(r.get(u,'left'),10)||0,inner_h:parseInt(r.get(u,'height'),10),inner_w:parseInt(r.get(u,'width'),10),outer_h:parseInt(r.get(this.$LitestandTagSuggestContainer2,'height'),10),outer_w:parseInt(r.get(this.$LitestandTagSuggestContainer2,'width'),10)};}var v=this.$LitestandTagSuggestContainera,w=100*(t.top*v.inner_h/100+v.top)/v.outer_h,x=100*(t.left*v.inner_w/100+v.left)/v.outer_w,y=t.width*v.inner_w/v.outer_w,z=t.height*v.inner_h/v.outer_h;return (o.div({className:"_5cnc hidden_elem",style:{top:w+'%',left:x+'%',width:y+'%',height:z+'%'}}));};s.prototype.onRemove=function(t){"use strict";var u=this.$LitestandTagSuggestContainer4.shift();this.$LitestandTagSuggestContainer7();n(u.js_instance===t);if(this.$LitestandTagSuggestContainer4.length===0){new g(this.$LitestandTagSuggestContainer1).ondone(function(){this.removeSingleSuggest(this.$LitestandTagSuggestContainer1);}.bind(this)).from('opacity',1).to('opacity',0).ease(g.ease.end).duration(500).go();this.cleanup();}else new g(t.suggest).ondone(function(){this.switchToNextSuggest(t.suggest,this.getNextFacebox().suggest);}.bind(this)).from('opacity',1).to('opacity',0).ease(g.ease.end).duration(500).go();};s.prototype.switchToNextSuggest=function(t,u){"use strict";h.show(u);new g(u).ondone(this.removeSingleSuggest.bind(this,t)).from('opacity',0).to('opacity',1).ease(g.ease.end).duration(500).go();};s.prototype.removeSingleSuggest=function(t){"use strict";k.remove(t);t.cleanup();};s.prototype.getNextFacebox=function(){"use strict";return this.$LitestandTagSuggestContainer4[0].js_instance;};s.prototype.$LitestandTagSuggestContainer6=function(){"use strict";if(!this.$LitestandTagSuggestContainer5){this.$LitestandTagSuggestContainer5=true;this.$LitestandTagSuggestContainer4.forEach(function(t,u,v){var w=this.$LitestandTagSuggestContainer8(t.position_data);k.appendContent(this.$LitestandTagSuggestContainer2,w);v[u].dom_element=w;}.bind(this));}this.$LitestandTagSuggestContainerb=this.$LitestandTagSuggestContainer4[0].dom_element;h.show(this.$LitestandTagSuggestContainerb);};s.prototype.$LitestandTagSuggestContainer7=function(){"use strict";this.$LitestandTagSuggestContainerb&&h.hide(this.$LitestandTagSuggestContainerb);this.$LitestandTagSuggestContainerb=null;};s.prototype.cleanup=function(){"use strict";this.$LitestandTagSuggestContainer0.release();};e.exports=s;},null);